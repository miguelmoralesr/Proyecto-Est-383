system("java -version")
install.packages("sparklyr")
library(sparklyr)
spark_available_versions()
spark_install("3.0")
rm(list=ls())
library(wbstats)
library(ggplot2)
library(dplyr)
wbindex<-wb_indicators("es")
wbcat<-wbdatacatalog()
wbpais<-wb_countries()
# Se eligió el estimador del pocentaje de personas en base a la población que tienen acceso a internet
Internet<-wb_data(country= c("BOL","ECU","PER"), indicator= "IT.NET.USER.ZS", start_date = 2005, end_date = 2020)
Internet<-Internet %>% rename(Usuarios_internet=IT.NET.USER.ZS, Año=date, Pais=country)
ggplot() + geom_line(data = Internet, aes(x=Año, y=Usuarios_internet, color=Pais))
install.packages("tuber")
library(tuber)
library(dplyr)
library(purrr)
library(ggplot2)
rm(list=ls())
spark_install("3.0")
sc <- spark_connect(master = "local")
spark_installed_versions()
library(sparklyr)
spark_installed_versions()
sc<-spark_connect(master = "local", version = "3.0.2")
install.packages("markovchain")
library(markovchain)
M = matrix(c(0.8,0.2,0.9,0.1),nrow = 2,byrow = TRUE)
P = new("markovchain", transitionMatrix= M, states=c("E1","E2"), name="Máquina")
P
plot(P)
rm(list=ls())
install.packages("dbplot")
library(dplyr)
library(sparklyr)
library(ggplot2)
library(dbplot)
config <- spark_config()
#Memoria
config["sparklyr.shell.driver-memory"] <- "8g"
#Núcleos
config["sparklyr.connect.cores.local"] <- 2
#Definiendo la memoria disponible para la ejecución y el almacenaje
config$spark.memory.fraction <- 0.90
#Definiendo la memoria disponible para la ejecución
config$spark.memory.storageFraction <- 0.90
#Conectar al cluster local con configuración personalizada
sc <- spark_connect(master = "local", config = config)
rm(list=ls())
library(dplyr)
library(sparklyr)
library(ggplot2)
library(dbplot)
# 0. Conexión
config <- spark_config()
#Memoria
config["sparklyr.shell.driver-memory"] <- "8g"
#Núcleos
config["sparklyr.connect.cores.local"] <- 2
#Definiendo la memoria disponible para la ejecución y el almacenaje
config$spark.memory.fraction <- 0.90
#Definiendo la memoria disponible para la ejecución
config$spark.memory.storageFraction <- 0.90
#Conectar al cluster local con configuración personalizada
sc <- spark_connect(master = "local", config = config)
spark_disconnect_all()
spark_disconnect_all()
sc <- spark_connect(master = "local", config = config, version = "2.4.7")
library(dplyr)
library(sparklyr)
library(ggplot2)
library(dbplot)
sc<-spark_connect(master = "local", version = "3.0.2")
spark_disconnect_all()
spark_disconnect_all()
sc<-spark_connect(master="local",version = "2.4.7")
load(url("https://github.com/AlvaroLimber/EST-383/raw/master/data/oct20.RData"))
sp_computo<-copy_to(sc, computo)
sp_importaciones<-spark_read_csv(sc,name="importaciones",path="E:\\Nueva carpeta\\Docs\\I 2021\\Big data\\Importaciones\\importaciones_csv")
# 2. Wrangle(exploración)
dimnames(sp_computo)
dimnames(sp_importaciones)
sp_computo %>% group_by(ElecciA3n) %>% count()
presi<-sp_computo %>% filter(ElecciA3n=="Presidente y Vicepresidente")
dimnames(presi)
presi %>% filter(Pais=="Bolivia") %>% group_by(Departamento) %>% select(Inscritos:Nulos) %>% summarise_all(sum)
dimnames(presi)
presi %>% filter(PaAs=="Bolivia") %>% group_by(Departamento) %>% select(Inscritos:Nulos) %>% summarise_all(sum)
presi %>% mutate(ccmas=(CC>MAS__IPSP)) %>% group_by(ccmas) %>% count()
# 3. Modelar la información
m1<-lm(CC~MNR+MAS__IPSP, data=presi)
summary(m1)
# 4. Comunicar los resultados
hist(presi$CC)
ggplot(presi, aes(CC)+geom_histogram())
ggplot(presi, aes(CC))+geom_histogram()
ggplot(sp_computo, aes(CC))+geom_histogram()
# 4. Comunicar los resultados
hist(presi$CC)
presi %>% select(CC) %>% dbplot_histogram()
# 4. Usando spark en sus computadoras o en rstudio cloud, cargue la encuesta a hogares 2019, defina una base con las variables, departamento, área, años de educación, sexo, para el jefe del hogar.
# Cargue la base a spark y con ese objeto cree una tabla que muestre el promedio de edad, porcentaje de pobreza, promedio de años de educación por departamento, área y sexo del jefe del hogar.
# Finalmente, usando la librería ggplot y la anterior tabla presente un gráfico.
library(sparklyr)
library(dplyr)
library(ggplot2)
sc<-spark_connect(master="local",version = "2.4.7")
load(url("https://github.com/AlvaroLimber/EST-383/raw/master/data/eh19.RData"))
jh<-eh19p %>% rename(sexo=s02a_02, edad=s02a_03) %>% filter(s02a_05=="1.JEFE O JEFA DEL HOGAR") %>% select(folio, depto, area, aestudio, sexo, edad)
aux<-eh19p %>%  mutate(pobreza = p0=="Pobre") %>% select(folio, pobreza) %>% group_by(folio) %>% summarise(pobreza=mean(pobreza))
jh<-merge(aux, jh)
sp_eh19p<-copy_to(sc, "eh19p")
sp_jh<-copy_to(sc, "jh")
spark_disconnect_all()
spark_disconnect_all()
sc<-spark_connect(master = "local", version = "3.0.2")
sp_eh19p<-copy_to(sc, "eh19p")
sp_eh19p<-copy_to(sc, eh19p)
spark_disconnect_all()
spark_disconnect_all()
sc<-spark_connect(master="local",version = "2.4.7")
sp_eh19p<-copy_to(sc, eh19p)
library(flexdashboard)
library(shiny)
library(dplyr)
library(plotly)
install.packages("plotly")
library(plotly)
library(flexdashboard)
library(shiny)
library(dplyr)
install.packages("plotly")
library(plotly)
eh19d<-read.csv("https://raw.githubusercontent.com/miguelmoralesr/Proyecto-Est-383/main/EH19Discriminacion.csv")
rm(list=ls())
eh19d<-read.csv("https://raw.githubusercontent.com/miguelmoralesr/Proyecto-Est-383/main/EH19Discriminacion.csv")
library(dplyr)
load(url("https://github.com/AlvaroLimber/EST-383/raw/master/data/eh19.RData"))
View(eh19p)
t0<-eh19p %>% filter(s02a_03>18) %>% select(s03a_04, s02a_03, aestudio, ylab)
View(t0)
t0<-eh19p %>% select(s03a_04, s02a_03, aestudio, ylab) %>% filter(s02a_03>18)
View(t0)
t0<-eh19p %>% group_by(s03a_04, s02a_03, aestudio, ylab) %>% filter(s02a_03>18) %>% summarise(s03a_04)
View(t0)
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(aestudio, ylab)
View(t0)
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(sum(aestudio), sum(ylab, na.rm = T))
View(t0)
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(sum(aestudio, na.rm = T), sum(ylab, na.rm = T))
View(t0)
t0<-eh19p %>% rename(s03a_04="originario") %>% group_by(originario) %>% filter(s02a_03>18) %>% summarise(a_estudio=sum(aestudio, na.rm = T), ingreso=sum(ylab, na.rm = T))
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(a_estudio=sum(aestudio, na.rm = T), ingreso=sum(ylab, na.rm = T))
View(t0)
plot(t0)
histogram(t0)
hist(t0)
library(ggplot2)
ggplot(t0, aes(s02a_03, a_estudio))+geom_histogram()
ggplot(t0, aes(s03a_04, a_estudio))+geom_histogram()
ggplot(t0, aes(s03a_04, a_estudio))+geom_bar()
ggplot(t0, aes(s03a_04))+geom_bar()
ggplot(t0, aes(s03a_04, ingreso))+geom_bar()
ggplot(t0, aes(s03a_04, ylab))+geom_bar()
ggplot(t0, aes(s03a_04, ingreso))+geom_bar()
View(t0)
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "s03a_04")
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "ingreso")
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "identity")
ggplot(t0, aes(s03a_04, ingreso, a_estudio))+geom_bar(stat = "identity")
ggplot(t0, aes(s03a_04, ingreso, a_estudio))+geom_bar(stat = "identity", position = "dodge")
ggplot(t0, aes(s03a_04, ingreso, a_estudio))+geom_bar(stat = "identity", position = "stack")
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "identity", position = "stack")
ggplot(t0, aes(s03a_04, a_estudio))+geom_bar(stat = "identity", position = "stack")
ggplot(t0, aes(s03a_04, a_estudio))+geom_bar(stat = "identity")
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(aestudio, ingreso=ylab)
View(t0)
ggplot(t0, aes(s03a_04, a_estudio))+geom_bar(stat = "identity")
ggplot(t0, aes(s03a_04, aestudio))+geom_bar(stat = "identity")
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% select(s03a_04, aestudio, ingreso=ylab)
View(t0)
ggplot(t0, aes(s03a_04, aestudio))+geom_bar(stat = "identity")
t0<-eh19p %>% group_by(s03a_04) %>% filter(s02a_03>18) %>% summarise(aestudio, ingreso=ylab)
View(t0)
ggplot(t0, aes(s03a_04, a_estudio))+geom_bar(stat = "identity")
ggplot(t0, aes(s03a_04, aestudio))+geom_bar(stat = "identity")
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "identity"
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "identity"
ggplot(t0, aes(s03a_04, ingreso))+geom_bar(stat = "identity")
View(eh19p)
jh<-eh19p %>% rename(sexo=s02a_02,edad=s02a_03) %>% filter(s02a_05=="1.JEFE O JEFA DEL HOGAR") %>% select(folio,sexo,edad,ylab,ynolab,yper,depto,aestudio,area)
View(jh)
aux<-eh19p %>% mutate(miembros=1,pers_menores5=(edad<=5),pers_mayores60=(edad>=60)) %>% select(folio,edad,miembros,pers_menores5,pers_mayores60) %>% group_by(folio) %>% summarise(miembros=sum(miembros),p5=sum(p5),p60=sum(p60))
aux<-eh19p %>% rename(edad=s02a_03) %>%  mutate(miembros=1,pers_menores5=(edad<=5),pers_mayores60=(edad>=60)) %>% select(folio,edad,miembros,pers_menores5,pers_mayores60) %>% group_by(folio) %>% summarise(miembros=sum(miembros),pers_menores5=sum(pers_menores5),pers_mayores60=sum(pers_mayores60))
View(aux)
aux2<-eh19v %>% rename(electricidad=s01a_19, internet=s01a_31) %>% filter(electricidad=="1. Si", internet=="1. Si") %>% select(folio,electricidad,internet)
View(aux2)
jh<-merge(jefe,aux)
jh<-merge(jh,aux)
jh<-merge(jh,aux2)
jh<-jh %>% filter(sexo=="2.Mujer")
View(jh)
library(knitr)
kable(jh)
t0<-eh19p %>% rename(originario=s03a_04) %>% group_by(originario) %>% filter(s02a_03>18) %>% summarise(aestudio, ingreso=ylab)
t0<-eh19p %>% rename(originario=s03a_04, edad=s02a_03) %>% group_by(originario) %>% filter(edad>18) %>% summarise(aestudio, ingreso=ylab)
View(t0)
t0<-eh19p %>% rename(originario=s03a_04, edad=s02a_03) %>% group_by(originario) %>% filter(edad>18) %>% summarise(edad, aestudio, ingreso=ylab)
View(t0)
ggplot(t0, aes(originario, aestudio))+geom_bar(stat = "identity")
View(eh19p)
ggplot(t0, aes(originario, ingreso))+geom_bar(stat = "identity")
kable(t0$originario, t0$edad, t0$aestudio)
kable(t0)
res<-eh19p %>% rename(originario=s03a_04, edad=s02a_03) %>% group_by(originario) %>% filter(edad>18) %>% summarise(edad, aestudio, ingreso=ylab)
rm(list=ls())
eh19d<-read.csv("https://raw.githubusercontent.com/miguelmoralesr/Proyecto-Est-383/main/EH19Discriminacion.csv")
install.packages("rnaturalearth")
library(rnaturalearth)
map <- ne_countries()
install.packages("sp")
install.packages("sp")
library(sp)
plot(map)
names(map)
map$iso_a3
plot(map$iso_a3=="BOL")
library(maps)
?rnaturalearth
?maps
??maps
setwd("E:\\Nueva carpeta\\Docs\\I 2021\\Big data\\Proyecto Est383\\Proyecto-Est-383")
install.packages("RColorBrewer")
library(RColorBrewer)
dir()
bol<-load("gadm36_BOL_2_sp.rds")
bol<-readRDS("gadm36_BOL_2_sp.rds")
plot(bol)
bol$NAME_1
plot(bol, col=c(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0))
plot(bol, col=c(0,1,0,0,0,0,0,0,0,0,0,0,0,0,0))
plot(bol, col=c(1,1,0,0,0,0,0,0,0,0,0,0,0,0,0))
bol<-readRDS("gadm36_BOL_1_sp.rds")
plot(bol)
bol$NAME_1
plot(bol, col=c(1,0,0,0,0,0,0,0,0)
plot(bol, col=c(1,0,0,0,0,0,0,0,0))
plot(bol, col=c(1,2,3,4,5,6,7,8,9))
plot(bol, col=c(1,0,4,5,6,7,8,9))
plot(bol, col=c(1,0,0,0,0,0,0,0))
plot(bol)
plot(bol, col=c(1,1,0,0,0,0,0,0))
plot(bol, col=c(0,1,0,0,0,0,0,0))
plot(bol, col=c(3,1,4,0,0,0,0,0))
plot(bol, col=c(6,1,4,0,0,0,0,0))
bol$NAME_1
plot(bol, col=c(6,1,4,0,0,0,0,1))
plot(bol, col=c(6,1,4,0,0,0,0,3))
plot(bol, col=c(6,1,4,0,0,0,7,3))
plot(bol, col=c(6,1,4,0,0,11,7,3))
plot(bol, col=c(6,1,4,0,0,11,7,3))
plot(bol, col=c(6,1,4,0,0,11,7,3,0))
bol<-readRDS("https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds?raw=true")
bol<-readRDS("https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds")
load(url(""))
load(url(""))
load(url("https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds?raw=true"))
https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds
bol<-readRDS("https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds")
bol<-readRDS(url("https://github.com/miguelmoralesr/Proyecto-Est-383/blob/main/gadm36_BOL_1_sp.rds"))
dir()
bol<-readRDS("gadm36_BOL_1_sp.rds")
rm(map)
names(bol)
names(bol$NAME_1)
names(bol$NAME_0)
View(bol)
bol$NAME_1
View(eh19d)
ind1<- eh19p %>% group_by(depto) %>% mutate(num_disc) %>% select(depto,s12a_01a, num_disc)
library(flexdashboard)
library(shiny)
library(dplyr)
library(plotly)
ind1<- eh19p %>% group_by(depto) %>% mutate(num_disc) %>% select(depto,s12a_01a, num_disc)
ind1<- eh19d %>% group_by(depto) %>% mutate(num_disc) %>% select(depto,s12a_01a, num_disc)
ind1<- eh19d %>% group_by(depto) %>% filter(s12a_01a=1,s12a_01b=1,s12a_01b=1,s12a_01d=1,s12a_01e=1,s12a_01f=1,s12a_01g=1) %>% select(depto,s12a_01a, s12a_01b, s12a_01c, s12a_01d, s12a_01e)
ind1<- eh19d %>% group_by(depto) %>% filter(s12a_01a==1,s12a_01b==1,s12a_01b==1,s12a_01d==1,s12a_01e==1,s12a_01f==1,s12a_01g==1) %>% select(depto,s12a_01a, s12a_01b, s12a_01c, s12a_01d, s12a_01e)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(s12a_01a=="1. Si",s12a_01b=="1. Si",s12a_01b=="1. Si",s12a_01d=="1. Si",s12a_01e=="1. Si",s12a_01f=="1. Si",s12a_01g=="1. Si") %>% select(depto,s12a_01a, s12a_01b, s12a_01c, s12a_01d, s12a_01e)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(s12a_01a=="1. Si",s12a_01b=="1. Si") %>% select(depto,s12a_01a, s12a_01b)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(s12a_01a=="1. Si") %>% select(depto,s12a_01a, s12a_01b)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto="La Paz") %>% select(depto,s12a_01a, s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% select(depto,s12a_01a, s12a_01b)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=1==s12a_01a="1. Si") %>% select(depto,s12a_01a, s12a_01b)
as.numeric(factor(eh19d$s12a_01a, levels = unique(eh19d$s12a_01a)))
as.numeric(factor(eh19d$s12a_01a))
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(eh19d$s12a_01a))) %>% select(depto,s12a_01a, s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a, s12a_01b)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,sum(s12a_01a==1), s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,a=sum(s12a_01a==1), s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,a=sum(s12a_01a), s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a, s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a=sum(s12a_01a), s12a_01b)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a=sum(s12a_01a))
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% group_by(a=sum(s12a_01a))
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% summarise(a=sum(s12a_01a))
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% summarise(depto,a=sum(s12a_01a))
View(ind1)
ind1<-ind1 %>% summarise(a=sum(s12a_01a))
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% summarise(a=sum(s12a_01a))
View(ind1)
ind1<-ind1 %>% summarise(a=sum(s12a_01a==1))
View(ind1)
ind1<-ind1 %>% filter(s12a_01a=1) %>% summarise(a=sum(s12a_01a))
ind1<-ind1 %>% filter(s12a_01a==1) %>% summarise(a=sum(s12a_01a))
ind1<-ind1 %>% filter(s12a_01a==1) %>% select(depto, a=sum(s12a_01a))
View(ind1)
ind1<-ind1 %>% filter(s12a_01a==1) %>% select(depto, s12a_01a)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% filter(s12a_01a==1) %>% select(depto, s12a_01a)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% filter(s12a_01a==1) %>% select(depto, sum(s12a_01a))
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% select(depto, sum(s12a_01a<=1))
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1))
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% filter(s12a_01a==1) %>% select(depto,s12a_01a)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1))
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto,sum)
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto,suma)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto,suma)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% select(depto,s12a_01a)
ind1<-ind1 %>% mutate(suma=sum(s12a_01a<=1)) %>% summarise(depto,suma)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto,s12a_01a)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto, sum)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a))) %>% mutate(suma=sum(s12a_01a<=1)) %>% select(depto, suma)
View(ind1)
ind1<- eh19d %>% group_by(depto) %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% select(depto, suma)
ind1<- eh19d %>% group_by(depto) %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% select(depto, suma)
View(ind1)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% group_by(depto) %>%  select(depto, suma)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% group_by(suma) %>%  select(depto, suma)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% group_by(suma) %>%  select(suma)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% select(suma)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% distinct() %>%  select(suma)
ind1<- eh19d %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% distinct() %>%  select(suma) %>% distinct()
View(ind1)
ind1<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), suma=sum(s12a_01a<=1)) %>% select(suma, depto) %>% distinct()
View(ind1)
lp<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01a<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1) ) %>% select(depto, genero, edad, sexo) %>% distinct()
View(lp)
lp<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
View(lp)
View(eh19d)
lp<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
sc<- eh19d %>% filter(depto=="Santa Cruz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cb<- eh19d %>% filter(depto=="Cochabamba") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cq<- eh19d %>% filter(depto=="Chuquisaca") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pd<- eh19d %>% filter(depto=="Pando") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
bn <- eh19d %>% filter(depto=="Beni") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
or<-eh19d %>% filter(depto=="Oruro") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pt<- eh19d %>% filter(depto=="Potosí") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
tj<- eh19d %>% filter(depto=="Tarija") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
View(bn)
ind1<- do.call("rbind", list(bn,cb,cq,lp,or,pd,pt,sc,tj))
View(ind1)
bol$NAME_1
View(ind1)
ind1[1,3]
ind1[3,1]
ind1[4,1]
ind1<- do.call("rbind", list(cq,cb,bn,lp,or,pd,pt,sc,tj))
ind1[4,1]
ind1[3,1]
ind1[3,1]="El Beni"
ind1[3,1]
ind1$num_disc<-rowSums(ind1[2:13])
ind1
ind1a<-ind1 %>% group_by(depto) %>% select(depto, num_disc)
View(ind1a)
bol$disc<-ind1a[match(bol$NAME_1, ind1a$depto), "num_disc"]
head(map)
install.packages("leaflet")
install.packages("leaflet")
library(leaflet)
pal<-colorBin(palette = "viridis", domain = bol$disc, bins = seq(0, max(bol$disc) + 10, by = 10))
bol$labels <- paste0("<strong> Departamento: </strong> ", bol$NAME_1, "<br/> ", "<strong> Nº de Agresiones: </strong> ", bol$disc, "<br/> ") %>% lapply(htmltools::HTML)
leaflet(map) %>% addTiles() %>% setView(lng = 0, lat = 30, zoom = 2) %>% addPolygons(fillColor = ~ pal(disc), color = "white", fillOpacity = 0.7, label = ~labels, highlight = highlightOptions(color = "black", bringToFront = TRUE)) %>% leaflet::addLegend(pal = pal, values = ~disc, opacity = 0.7, title = "Discriminaciones")
pal<-colorBin(palette = "viridis", domain = bol$disc, bins = seq(0, max(bol$disc) + 10, by = 10))
install.packages("viridislite")
install.packages("viridisLite")
install.packages("viridisLite")
library(viridislite)
library(viridisLite)
pal<-colorBin(palette = "viridis", domain = bol$disc, bins = seq(0, max(bol$disc) + 10, by = 10))
library(flexdashboard)
library(shiny)
library(dplyr)
library(plotly)
library(sp)
library(RColorBrewer)
library(leaflet)
library(viridisLite)
pal<-colorBin(palette = "viridis", domain = bol$disc, bins = seq(0, max(bol$disc) + 10, by = 10))
bol$labels <- paste0("<strong> Departamento: </strong> ", bol$NAME_1, "<br/> ", "<strong> Nº de Agresiones: </strong> ", bol$disc, "<br/> ") %>% lapply(htmltools::HTML)
leaflet(map) %>% addTiles() %>% setView(lng = 0, lat = 30, zoom = 2) %>% addPolygons(fillColor = ~ pal(disc), color = "white", fillOpacity = 0.7, label = ~labels, highlight = highlightOptions(color = "black", bringToFront = TRUE)) %>% leaflet::addLegend(pal = pal, values = ~disc, opacity = 0.7, title = "Discriminaciones")
leaflet(bol) %>% addTiles() %>% setView(lng = 0, lat = 30, zoom = 2) %>% addPolygons(fillColor = ~ pal(disc), color = "white", fillOpacity = 0.7, label = ~labels, highlight = highlightOptions(color = "black", bringToFront = TRUE)) %>% leaflet::addLegend(pal = pal, values = ~disc, opacity = 0.7, title = "Discriminaciones")
install.packages("sf")
library(sf)
setwd("E:\\Nueva carpeta\\Docs\\I 2021\\Big data\\Proyecto Est383\\Proyecto-Est-383")
rm(list=ls())
eh19d<-read.csv("https://raw.githubusercontent.com/miguelmoralesr/Proyecto-Est-383/main/EH19Discriminacion.csv")
dir()
bol_map<-st_read("limites_departamentales_bol.shp")
bol_map<-st_read("limites_departamentales_bol.shp")
library(dplyr)
library(ggplot2)
bol_map %>% ggplot()+geom_sf()
bol_map
View(bol_map)
lp<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
sc<- eh19d %>% filter(depto=="Santa Cruz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cb<- eh19d %>% filter(depto=="Cochabamba") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cq<- eh19d %>% filter(depto=="Chuquisaca") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pd<- eh19d %>% filter(depto=="Pando") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
bn <- eh19d %>% filter(depto=="Beni") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
or<-eh19d %>% filter(depto=="Oruro") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pt<- eh19d %>% filter(depto=="Potosí") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
tj<- eh19d %>% filter(depto=="Tarija") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
ind1<- do.call("rbind", list(cq,cb,bn,lp,or,pd,pt,sc,tj))
ind1[3,1]="El Beni"
ind1$num_disc<-rowSums(ind1[2:13])
ind1a<-ind1 %>% group_by(depto) %>% select(depto, num_disc)
View(ind1a)
bol_map<-st_read("limites_departamentales_bol.shp")
View(bol_map)
View(bol_map)
bol_map$disc<-ind1a[match(bol_map$NOMBRE, ind1a$depto), "num_disc"]
bol_map %>% ggplot(aes(fill=disc))+geom_sf()
View(bol_map)
bol_map %>% ggplot(aes(fill=disc.num_disc))+geom_sf()
View(ind1a)
bol_map<-st_read("limites_departamentales_bol.shp")
View(bol_map)
lp<- eh19d %>% filter(depto=="La Paz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
sc<- eh19d %>% filter(depto=="Santa Cruz") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cb<- eh19d %>% filter(depto=="Cochabamba") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
cq<- eh19d %>% filter(depto=="Chuquisaca") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pd<- eh19d %>% filter(depto=="Pando") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
bn <- eh19d %>% filter(depto=="Beni") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
or<-eh19d %>% filter(depto=="Oruro") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
pt<- eh19d %>% filter(depto=="Potosí") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
tj<- eh19d %>% filter(depto=="Tarija") %>% mutate(s12a_01a=as.numeric(factor(s12a_01a)), genero=sum(s12a_01a<=1), s12a_01b=as.numeric(factor(s12a_01b)), edad=sum(s12a_01b<=1), s12a_01c=as.numeric(factor(s12a_01c)), sexo=sum(s12a_01c<=1), s12a_01d=as.numeric(factor(s12a_01d)), col_piel=sum(s12a_01d<=1), s12a_01e=as.numeric(factor(s12a_01e)), npioc=sum(s12a_01e<=1), s12a_01f=as.numeric(factor(s12a_01f)), idioma=sum(s12a_01f<=1), s12a_01g=as.numeric(factor(s12a_01g)), vest=sum(s12a_01g<=1), s12a_01h=as.numeric(factor(s12a_01h)), extranjero=sum(s12a_01h<=1), s12a_01i=as.numeric(factor(s12a_01i)), discap=sum(s12a_01i<=1), s12a_01j=as.numeric(factor(s12a_01j)), religion=sum(s12a_01j<=1), s12a_01k=as.numeric(factor(s12a_01k)), pobreza=sum(s12a_01k<=1), s12a_01l=as.numeric(factor(s12a_01l)), otro=sum(s12a_01l<=1)) %>% select(depto, genero, edad, sexo, col_piel, npioc, idioma, vest, extranjero, discap, religion, pobreza, otro) %>% distinct()
ind1<- do.call("rbind", list(cq,cb,bn,lp,or,pd,pt,sc,tj))
View(ind1)
ind1<- do.call("rbind", list(cq,lp,cb,or,pt,tj,sc,bn,pd))
View(ind1)
ind1[5,1]="Potosi"
View(ind1)
ind1$num_disc<-rowSums(ind1[2:13])
ind1a<-ind1 %>% group_by(depto) %>% select(depto, num_disc)
bol_map$disc<-ind1a[match(bol_map$NOMBRE, ind1a$depto), "num_disc"]
bol_map %>% ggplot(aes(fill=disc))+geom_sf()
View(bol_map)
bol_map %>% ggplot(aes(fill=disc.num_disc))+geom_sf()
bol_map %>% ggplot()+geom_sf()
bol_map<-st_read("limites_departamentales_bol.shp")
bol_map$num_disc<-ind1a[match(bol_map$NOMBRE, ind1a$depto), "num_disc"]
bol_map %>% ggplot(aes(fill=disc))+geom_sf()
bol_map %>% ggplot(aes(fill=num_disc))+geom_sf()
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf(colour = "grey75", size = 0.05) + labs(title = "bol") + theme_bw() + theme(legend.position = "bottom")
View(bol_map)
bol_map
bol_map<-st_read("limites_departamentales_bol.shp")
bol_map <- bol_map %>% left_join(num_disc, by = c("NOMBRE" = "depto"))
bol_map <- bol_map %>% left_join(ind1a, by = c("NOMBRE" = "depto"))
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf(colour = "grey75", size = 0.05) + labs(title = "bol") + theme_bw() + theme(legend.position = "bottom")
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf() + labs(title = "bol") + theme_bw()
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf(colour = "grey75", size = 0.07) + labs(title = "Bolivia: Total de agresiones discriminatorias por departamento", caption = "Datos: Encuesta Hogares 2019") + scale_fill_gradient("Número de agresiones", high="green", low="white") theme_bw()
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf() + labs(title = "Bolivia: Total de agresiones discriminatorias por departamento", caption = "Datos: Encuesta Hogares 2019") + scale_fill_gradient("Número de agresiones", high="green", low="white") theme_bw()
#bol$disc<-ind1a[match(bol$NAME_1, ind1a$depto), "num_disc"]
#pal<-colorBin(palette = "viridis", domain = bol$disc, bins = seq(0, max(bol$disc) + 10, by = 10))
#bol$labels <- paste0("<strong> Departamento: </strong> ", bol$NAME_1, "<br/> ", "<strong> Nº de Agresiones: </strong> ", bol$disc, "<br/> ") %>% lapply(htmltools::HTML)
#leaflet(bol) %>% addTiles() %>% setView(lng = 0, lat = 30, zoom = 2) %>% addPolygons(fillColor = ~ pal(disc), color = "white", fillOpacity = 0.7, label = ~labels, highlight = highlightOptions(color = "black", bringToFront = TRUE)) %>% leaflet::addLegend(pal = pal, values = ~disc, opacity = 0.7, title = "Discriminaciones")
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf() + labs(title = "Bolivia: Total de agresiones discriminatorias por departamento", caption = "Datos: Encuesta Hogares 2019") + scale_fill_gradient("Número de agresiones", high="green", low="white") theme_bw()
bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf(colour = "grey75", size = 0.07) + labs(title = "Bolivia: Total de agresiones discriminatorias por departamento", caption = "Datos: Encuesta Hogares 2019") + scale_fill_gradient("Número de agresiones", high="green", low="white") + theme_bw()
library(plotly)
map_disc<-bol_map %>% ggplot(aes(fill = num_disc)) + geom_sf(colour = "grey75", size = 0.07) + labs(title = "Bolivia: Total de agresiones discriminatorias por departamento", caption = "Datos: Encuesta Hogares 2019") + scale_fill_gradient("Número de agresiones", high="green", low="white") + theme_bw()
ggplotly(map_disc)
setwd("E:\\Nueva carpeta\\Docs\\I 2021\\Big data\\Proyecto Est383\\Proyecto-Est-383")
